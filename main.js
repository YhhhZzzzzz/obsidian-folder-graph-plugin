/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var x=(r,t)=>{for(var e in t)g(r,e,{get:t[e],enumerable:!0})},N=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of w(t))!y.call(r,n)&&n!==e&&g(r,n,{get:()=>t[n],enumerable:!(i=f(t,n))||i.enumerable});return r};var P=r=>N(g({},"__esModule",{value:!0}),r);var T={};x(T,{default:()=>p});module.exports=P(T);var a=require("obsidian"),S={mapFolderName:"_GraphMaps",prefix:"Map_"},p=class extends a.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"rebuild-graph-map",name:"Rebuild Graph Map (\u751F\u6210\u5F71\u5B50\u56FE\u8C31)",callback:()=>{this.generateGraphMap()}}),this.addSettingTab(new d(this.app,this))}async generateGraphMap(){new a.Notice("\u5F00\u59CB\u6784\u5EFA\u5F71\u5B50\u56FE\u8C31...");let t=this.app.vault,{mapFolderName:e,prefix:i}=this.settings,n=t.getAbstractFileByPath(e);n||(await t.createFolder(e),n=t.getAbstractFileByPath(e));let l=t.getRoot();await this.processFolder(l,t),new a.Notice("\u56FE\u8C31\u6784\u5EFA\u5B8C\u6210\uFF01")}async processFolder(t,e){let{mapFolderName:i,prefix:n}=this.settings,l=[],u=t.children.sort((s,h)=>s.name.localeCompare(h.name));for(let s of u)if(s instanceof a.TFolder){if(s.name===i)continue;await this.processFolder(s,e);let h=`${n}${this.cleanPath(s.path)}`;l.push(`- [[${h}|\u{1F4C2} ${s.name}]]`)}else s instanceof a.TFile&&s.extension==="md"&&!s.path.includes(i)&&l.push(`- [[${s.path}|\u{1F4C4} ${s.basename}]]`);if(l.length===0)return;let F=`${n}${this.cleanPath(t.path)}.md`,m=`${i}/${F}`,c=`---
tags: [auto-graph-map]
---
# \u{1F5FA}\uFE0F \u67B6\u6784\u56FE: ${t.name}

${l.join(`
`)}
`,o=e.getAbstractFileByPath(m);o instanceof a.TFile?await e.read(o)!==c&&await e.modify(o,c):!o&&t.path!=="/"&&await e.create(m,c)}cleanPath(t){return t==="/"?"ROOT":t.replace(/\//g,"_").replace(/\\/g,"_").replace(/\s/g,"-")}async loadSettings(){this.settings=Object.assign({},S,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},d=class extends a.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Folder Graph \u8BBE\u7F6E"}),new a.Setting(t).setName("\u5F71\u5B50\u56FE\u8C31\u5B58\u653E\u6587\u4EF6\u5939").setDesc("\u6240\u6709\u7684\u7D22\u5F15\u6587\u4EF6\u5C06\u5B58\u653E\u5728\u8FD9\u91CC").addText(e=>e.setPlaceholder("_GraphMaps").setValue(this.plugin.settings.mapFolderName).onChange(async i=>{this.plugin.settings.mapFolderName=i,await this.plugin.saveSettings()})),new a.Setting(t).setName("\u7D22\u5F15\u6587\u4EF6\u524D\u7F00").setDesc("\u4F8B\u5982 Map_DailyTasks.md").addText(e=>e.setPlaceholder("Map_").setValue(this.plugin.settings.prefix).onChange(async i=>{this.plugin.settings.prefix=i,await this.plugin.saveSettings()}))}};
